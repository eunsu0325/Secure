# config/config.yaml

Dataset:
  train_set_file: /content/drive/MyDrive/Data/GPDSmanosASM_txt/train_palma.txt
  test_set_file: /content/drive/MyDrive/Data/GPDSmanosASM_txt/test_palma.txt
  height: 128
  width: 128
  channels: 1
  augmentation: true
  negative_samples_file: /content/drive/MyDrive/CCNet_OKD_CD/data/train_Tongji.txt
  num_negative_classes: 100

Model:
  architecture: ccnet
  competition_weight: 0.8
  use_pretrained: true
  pretrained_path: /content/drive/MyDrive/net_params1.pth
  # ğŸ§€ í”„ë¡œì ì…˜ í—¤ë“œ ì„¤ì •
  projection_dim: 512
  use_projection: true

Training:
  scr_batch_size: 18
  memory_batch_size: 110
  num_experiences: 100
  memory_size: 1000
  min_samples_per_class: 9
  scr_epochs: 5
  iterations_per_epoch: 10
  num_epochs: 3000  # (ì‚¬ìš© ì•ˆ í•¨)
  num_workers: 8
  learning_rate: 0.0001
  scheduler_step_size: 50
  scheduler_gamma: 0.8
  temperature: 0.07  # SupConLossìš©
  save_interval: 1000  # (ì‚¬ìš© ì•ˆ í•¨)
  test_interval: 5  # â­ í‰ê°€ ë° ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ì£¼ê¸°
  checkpoint_path: /content/drive/MyDrive/cvc
  results_path: /content/drive/MyDrive/cvc
  gpu_ids: "0"
  ncm_momentum: 1.0
  seed: 42  # ğŸ¥© ì¶”ê°€!


  # ğŸ¦ˆ ProxyAnchorLoss ì„¤ì • ì¶”ê°€
  use_proxy_anchor: true
  proxy_margin: 0.5        # Proxy Anchor margin Î´
  proxy_alpha: 64          # Proxy Anchor scaling Î±
  proxy_lr_ratio: 1       # í”„ë¡ì‹œ í•™ìŠµë¥  ë°°ìˆ˜ (ë°±ë³¸ì˜ 10ë°°)
  proxy_lambda: 0.5        # ğŸ¦ˆ ê³ ì • ê°€ì¤‘ì¹˜ (0.3 = 30% ProxyAnchor, 70% SupCon)

# ğŸ‹ ì˜¤í”ˆì…‹ ì¸ì‹ ì„¤ì •
Openset:
  enabled: true

  # â˜„ï¸ ì„ê³„ì¹˜ ì„¤ì •
  threshold_mode: 'far'      # 'eer' or 'far'
  target_far: 0.01           # FAR íƒ€ê²Ÿ 1%
  threshold_alpha: 1.0       # EMA ìŠ¤ë¬´ë”© ê³„ìˆ˜
  threshold_max_delta: 1.0  # ìµœëŒ€ ë³€í™”í­
  
  # ì´ˆê¸°ê°’ ë° ì›Œë°ì—…
  warmup_users: 10           # ì›Œë°ì—… ê¸°ê°„
  initial_tau: 0.5           # ì´ˆê¸° ì„ê³„ì¹˜
  
  # ë°ì´í„° ë¶„í• 
  dev_ratio: 0.1             # Dev ì„¸íŠ¸ ë¹„ìœ¨
  negref_max_eval: 100      # NegRef ìµœëŒ€ ìƒ˜í”Œ
  
  # ë¡œê¹…
  verbose_calibration: true  # ìƒì„¸ ì¶œë ¥

  # ğŸ¥© TTA ì„¤ì • (Test-Time Augmentation)
  tta_n_views: 3  # 1=ë¹„í™œì„±, 2~3 ê¶Œì¥
  tta_include_original: true  # ì›ë³¸ í¬í•¨ ê¶Œì¥
  tta_agree_k: 0  # 0=ê³¼ë°˜ ìë™, 2=2ê°œ ì´ìƒ ë™ì˜
  tta_augmentation_strength: 1.0  # 0.3~0.7 ê¶Œì¥
  tta_aggregation: 'mean'  # 'median' or 'mean'
  
  # ğŸª» ê¸°ì¡´ TTA ë°˜ë³µ ì„¤ì •
  # tta_n_repeats: 3  # TTA ë°˜ë³µ íšŸìˆ˜
  
  # ğŸ¾ íƒ€ì…ë³„ ë…ë¦½ì ì¸ TTA ë°˜ë³µ ì„¤ì •
  tta_n_repeats_genuine: 2      # Genuine ì ìˆ˜: 3ë²ˆ ë°˜ë³µ (ì •í™•ë„ ì¤‘ìš”)
  tta_n_repeats_between: 2      # Between impostor: 2ë²ˆ ë°˜ë³µ (ê· í˜•)
  tta_n_repeats_negref: 0       # NegRef: 1ë²ˆ (ë©”ëª¨ë¦¬ ì ˆì•½)
  tta_repeat_aggregation: 'mean'  # ë°˜ë³µ ê°„ ì§‘ê³„ ë°©ë²•
  tta_verbose: true  # TTA ë””ë²„ê¹… ì¶œë ¥
  
  # ğŸ¾ Impostor ì ìˆ˜ ë¹„ìœ¨ ì„¤ì • (í•©ì´ 1.0ì´ ë˜ì–´ì•¼ í•¨)
  impostor_ratio_between: 1.0    # Between impostor 30%
  impostor_ratio_unknown: 0.0    # Unknown 0% (í˜„ì¬ ë¯¸ì‚¬ìš©)
  impostor_ratio_negref: 0.0     # NegRef 70%
  impostor_balance_total: 6000   # ê· í˜• ë§ì¶œ ì´ ìƒ˜í”Œ ìˆ˜

# ğŸ”¥ ë„¤ê±°í‹°ë¸Œ ìƒ˜í”Œ ì„¤ì •
Negative:
  warmup_experiences: 4
  max_per_batch: 1
  r0: 0.5
